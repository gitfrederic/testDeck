
teaminfo <- data.frame(team = character(0), flagimg = character(0), winprob = numeric(0), stringsAsFactors = FALSE)
teaminfo <- rbind(teaminfo, data.frame(team = 'Algeria', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03_qj1__42x22.png', winprob = 0.1))
teaminfo <- rbind(teaminfo, data.frame(team = 'Argentina', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-02bh_v__42x22.png', winprob = 14.3))
teaminfo <- rbind(teaminfo, data.frame(team = 'Australia', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-0cnk2q__42x22.png', winprob = 0.0))
teaminfo <- rbind(teaminfo, data.frame(team = 'Belgium', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-0329gm__42x22.png', winprob = 8.5))
teaminfo <- rbind(teaminfo, data.frame(team = 'Bosnia and Herzegovina', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03yv9r__42x22.png', winprob = 0.5))
teaminfo <- rbind(teaminfo, data.frame(team = 'Brazil', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-01352___42x22.png', winprob = 21.2))
teaminfo <- rbind(teaminfo, data.frame(team = 'Cameroon', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03yl2t__42x22.png', winprob = 0.0))
teaminfo <- rbind(teaminfo, data.frame(team = 'Chile', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-033nzk__42x22.png', winprob = 2.7))
teaminfo <- rbind(teaminfo, data.frame(team = 'Colombia', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-032c08__42x22.png', winprob = 5.4))
teaminfo <- rbind(teaminfo, data.frame(team = 'Costa Rica', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03zb6t__42x22.png', winprob = 0.3))
teaminfo <- rbind(teaminfo, data.frame(team = 'Croatia', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-0356gk__42x22.png', winprob = 0.4))
teaminfo <- rbind(teaminfo, data.frame(team = 'Ecuador', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03zj_3__42x22.png', winprob = 0.2))
teaminfo <- rbind(teaminfo, data.frame(team = 'England', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-02pp1__42x22.png', winprob = 0.6))
teaminfo <- rbind(teaminfo, data.frame(team = 'France', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-01l3vx__42x22.png', winprob = 4.7))
teaminfo <- rbind(teaminfo, data.frame(team = 'Germany', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-01l3wr__42x22.png', winprob = 15.0))
teaminfo <- rbind(teaminfo, data.frame(team = 'Ghana', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03_qrp__42x22.png', winprob = 0.2))
teaminfo <- rbind(teaminfo, data.frame(team = 'Greece', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-035qgm__42x22.png', winprob = 0.9))
teaminfo <- rbind(teaminfo, data.frame(team = 'Netherlands', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-02ltg3__42x22.png', winprob = 7.3))
teaminfo <- rbind(teaminfo, data.frame(team = 'Honduras', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03z8bw__42x22.png', winprob = 0.0))
teaminfo <- rbind(teaminfo, data.frame(team = 'Iran', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-01n_2f__42x22.png', winprob = 0.0))
teaminfo <- rbind(teaminfo, data.frame(team = 'Italy', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-01_lhg__42x22.png', winprob = 5.5))
teaminfo <- rbind(teaminfo, data.frame(team = "CÃ´te d'Ivoire", flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-040pyq__42x22.png', winprob = 0.8))
teaminfo <- rbind(teaminfo, data.frame(team = 'Japan', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03xh50__42x22.png', winprob = 0.2))
teaminfo <- rbind(teaminfo, data.frame(team = 'Mexico', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03dj48__42x22.png', winprob = 1.3))
teaminfo <- rbind(teaminfo, data.frame(team = 'Nigeria', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03ylxn__42x22.png', winprob = 0.4))
teaminfo <- rbind(teaminfo, data.frame(team = 'Portugal', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-02rqxc__42x22.png', winprob = 3.2))
teaminfo <- rbind(teaminfo, data.frame(team = 'Russia', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03262k__42x22.png', winprob = 1.2))
teaminfo <- rbind(teaminfo, data.frame(team = 'Korea Republic', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-03zrhb__42x22.png', winprob = 0.2))
teaminfo <- rbind(teaminfo, data.frame(team = 'Spain', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-02w64f__42x22.png', winprob = 0.0))
teaminfo <- rbind(teaminfo, data.frame(team = 'Switzerland', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-032jlh__42x22.png', winprob = 1.6))
teaminfo <- rbind(teaminfo, data.frame(team = 'United States', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-02s9vc__42x22.png', winprob = 1.2))
teaminfo <- rbind(teaminfo, data.frame(team = 'Uruguay', flagimg = 'https://ssl.gstatic.com/onebox/sports/worldcup/flags//-m-0329r5__42x22.png', winprob = 2.0))


shinyServer(function(input, output) {

    output$team <- renderText({
        if (input$team != 'Select a team')
            paste("You selected <strong>", input$team, "</strong>.", sep = "")
        else
            paste("", sep = "")
    })

    output$flag <- renderText({
        if (input$team != 'Select a team')
            paste("<img src=", teaminfo[teaminfo$team == input$team,]$flagimg, "></img>", sep = "")
        else
            paste("<img></img>", sep = "")
    })
 
    output$projection <- renderText({
        if (input$team != 'Select a team')
            paste("As of June 19th, 2014 (4pm Pacific Time) the probability that <strong>", input$team, "</strong> will win is: <strong>", teaminfo[teaminfo$team == input$team,]$winprob, "%</strong>.", sep = "")
        else
            paste("<img></img>", sep = "")
    })
    
    output$datasource <- renderText({
        if (input$team != 'Select a team')
            paste("The data source for the above projection is from <a href='https://www.bsports.com/world-cup#projections'>Bloomberg Sports</a> taken on June 19th, 2014 (4pm Pacific Time).<p><small>NOTE: Ideally, this Shiny App would use an API exposed by Bloomberg Sports to obtain projections in real-time, however the author of this Shiny App was unable to find an API that would allow this.", sep = "")
        else
            paste("<img></img>", sep = "")
    })

})
